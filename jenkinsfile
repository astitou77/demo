pipeline {
    agent any

    stages {
        
        stage('1/5 REPOSITORY') {
            steps {
                echo 'Pulling Github source code FROM astit77...'
                // git 'https://github.com/astitou77/demo.git'


                script {
                    // Define the repository URL
                    def repoUrl = 'git@github.com:astitou77/demo.git'

                    // Checkout the main branch using the stored SSH credentials
                    checkout([$class: 'git',
                              userRemoteConfigs: [[
                                  url: repoUrl,
                                  credentialsId: 'github-creds'
                              ]],
                              branches: [[name: '*/main']]
                    ])
                }


            }
        }
        
        stage('2/5 BUILD') {
            steps {
                echo 'MAVEN Building the *.war file package from source code...'
                sh 'mvn clean package -f "./pom.xml"'
            }
        }
        
        stage('3/5 TESTS') {
            steps {
                echo 'MAVEN Building the *.war file package from source code...'
                sh 'mvn test'
            }
        }
        
        stage('4/5 DEPLOY') {
            steps {
                echo 'Sending Email notification'
                echo 'installing new package to tomcat site...'
            }
        }
        
        stage('5/5 ARTIFACTORY') {
            steps {
                echo 'Storing latest package version to the JFrog Artifactory...'

            }
        }
        
        
    }
    
}

